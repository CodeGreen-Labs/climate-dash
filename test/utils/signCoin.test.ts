import { describe, expect, it } from 'vitest'

import { generateSeedFromMnemonic } from '../../src/utils/chia'
import { onGetAggregateSignature } from '../../src/utils/chia/coin'

describe('signCoin', async () => {
  const mockLineageProof = [
    {
      coin: {
        amount: 100000,
        parent_coin_info:
          '0x75cf7753c84c549859ad0476b78862464cb741dac0269c89d2a8044f9f01f6a4',
        puzzle_hash:
          '0xd85ac735b59ff2cb3b9f6eef8643f881cc986fbb02ecb9d00c9d9fe2583d2272',
      },
      coinName:
        '279bf853b68dd3ef4bf7a4a609e7f81e51a2350db463319f6825b235e8960626',
      puzzle_reveal:
        '0xff02ffff01ff02ffff01ff02ff5effff04ff02ffff04ffff04ff05ffff04ffff0bff34ff0580ffff04ff0bff80808080ffff04ffff02ff17ff2f80ffff04ff5fffff04ffff02ff2effff04ff02ffff04ff17ff80808080ffff04ffff02ff2affff04ff02ffff04ff82027fffff04ff82057fffff04ff820b7fff808080808080ffff04ff81bfffff04ff82017fffff04ff8202ffffff04ff8205ffffff04ff820bffff80808080808080808080808080ffff04ffff01ffffffff3d46ff02ff333cffff0401ff01ff81cb02ffffff20ff02ffff03ff05ffff01ff02ff32ffff04ff02ffff04ff0dffff04ffff0bff7cffff0bff34ff2480ffff0bff7cffff0bff7cffff0bff34ff2c80ff0980ffff0bff7cff0bffff0bff34ff8080808080ff8080808080ffff010b80ff0180ffff02ffff03ffff22ffff09ffff0dff0580ff2280ffff09ffff0dff0b80ff2280ffff15ff17ffff0181ff8080ffff01ff0bff05ff0bff1780ffff01ff088080ff0180ffff02ffff03ff0bffff01ff02ffff03ffff09ffff02ff2effff04ff02ffff04ff13ff80808080ff820b9f80ffff01ff02ff56ffff04ff02ffff04ffff02ff13ffff04ff5fffff04ff17ffff04ff2fffff04ff81bfffff04ff82017fffff04ff1bff8080808080808080ffff04ff82017fff8080808080ffff01ff088080ff0180ffff01ff02ffff03ff17ffff01ff02ffff03ffff20ff81bf80ffff0182017fffff01ff088080ff0180ffff01ff088080ff018080ff0180ff04ffff04ff05ff2780ffff04ffff10ff0bff5780ff778080ffffff02ffff03ff05ffff01ff02ffff03ffff09ffff02ffff03ffff09ff11ff5880ffff0159ff8080ff0180ffff01818f80ffff01ff02ff26ffff04ff02ffff04ff0dffff04ff0bffff04ffff04ff81b9ff82017980ff808080808080ffff01ff02ff7affff04ff02ffff04ffff02ffff03ffff09ff11ff5880ffff01ff04ff58ffff04ffff02ff76ffff04ff02ffff04ff13ffff04ff29ffff04ffff0bff34ff5b80ffff04ff2bff80808080808080ff398080ffff01ff02ffff03ffff09ff11ff7880ffff01ff02ffff03ffff20ffff02ffff03ffff09ffff0121ffff0dff298080ffff01ff02ffff03ffff09ffff0cff29ff80ff3480ff5c80ffff01ff0101ff8080ff0180ff8080ff018080ffff0109ffff01ff088080ff0180ffff010980ff018080ff0180ffff04ffff02ffff03ffff09ff11ff5880ffff0159ff8080ff0180ffff04ffff02ff26ffff04ff02ffff04ff0dffff04ff0bffff04ff17ff808080808080ff80808080808080ff0180ffff01ff04ff80ffff04ff80ff17808080ff0180ffff02ffff03ff05ffff01ff04ff09ffff02ff56ffff04ff02ffff04ff0dffff04ff0bff808080808080ffff010b80ff0180ff0bff7cffff0bff34ff2880ffff0bff7cffff0bff7cffff0bff34ff2c80ff0580ffff0bff7cffff02ff32ffff04ff02ffff04ff07ffff04ffff0bff34ff3480ff8080808080ffff0bff34ff8080808080ffff02ffff03ffff07ff0580ffff01ff0bffff0102ffff02ff2effff04ff02ffff04ff09ff80808080ffff02ff2effff04ff02ffff04ff0dff8080808080ffff01ff0bffff0101ff058080ff0180ffff04ffff04ff30ffff04ff5fff808080ffff02ff7effff04ff02ffff04ffff04ffff04ff2fff0580ffff04ff5fff82017f8080ffff04ffff02ff26ffff04ff02ffff04ff0bffff04ff05ffff01ff808080808080ffff04ff17ffff04ff81bfffff04ff82017fffff04ffff02ff2affff04ff02ffff04ff8204ffffff04ffff02ff76ffff04ff02ffff04ff09ffff04ff820affffff04ffff0bff34ff2d80ffff04ff15ff80808080808080ffff04ff8216ffff808080808080ffff04ff8205ffffff04ff820bffff808080808080808080808080ff02ff5affff04ff02ffff04ff5fffff04ff3bffff04ffff02ffff03ff17ffff01ff09ff2dffff02ff2affff04ff02ffff04ff27ffff04ffff02ff76ffff04ff02ffff04ff29ffff04ff57ffff04ffff0bff34ff81b980ffff04ff59ff80808080808080ffff04ff81b7ff80808080808080ff8080ff0180ffff04ff17ffff04ff05ffff04ff8202ffffff04ffff04ffff04ff78ffff04ffff0eff5cffff02ff2effff04ff02ffff04ffff04ff2fffff04ff82017fff808080ff8080808080ff808080ffff04ffff04ff20ffff04ffff0bff81bfff5cffff02ff2effff04ff02ffff04ffff04ff15ffff04ffff10ff82017fffff11ff8202dfff2b80ff8202ff80ff808080ff8080808080ff808080ff138080ff80808080808080808080ff018080ffff04ffff01a037bef360ee858133b69d595a906dc45d01af50379dad515eb9518abb7c1d2a7affff04ffff01a073dd418ff67e6079f06c7cc8cee637c7adc314210dca26997d634692f6c16087ffff04ffff01ff02ffff01ff02ffff01ff02ffff03ff0bffff01ff02ffff03ffff09ff05ffff1dff0bffff1effff0bff0bffff02ff06ffff04ff02ffff04ff17ff8080808080808080ffff01ff02ff17ff2f80ffff01ff088080ff0180ffff01ff04ffff04ff04ffff04ff05ffff04ffff02ff06ffff04ff02ffff04ff17ff80808080ff80808080ffff02ff17ff2f808080ff0180ffff04ffff01ff32ff02ffff03ffff07ff0580ffff01ff0bffff0102ffff02ff06ffff04ff02ffff04ff09ff80808080ffff02ff06ffff04ff02ffff04ff0dff8080808080ffff01ff0bffff0101ff058080ff0180ff018080ffff04ffff01b09968067d2192d9e9a04959635a0da5931f6bdd6a19975c64e09afb186175b4c2dba83f003bbe0abe64d95294bceed07bff018080ff0180808080',
      solution:
        '0xffff80ffff01ffff33ffa0cf3f7a8850dc7c27990b3e9e77c436f53a787dfb54683f8cb9e23ee6b26618efff830186a0ffffc04063663366376138383530646337633237393930623365396537376334333666353361373837646662353436383366386362396532336565366232363631386566ff808080ffff3cffa0af66a962fdc277708dd30366bb984582e5e87cee3b00903cf5684d92b18f87aa8080ff8080ffffa0cdc57f0c587d312786c41f165aa901fd809d801f4f934ad698523cfb016e8e43ffa0068a63ece551c597be7c86d06186c3fc2a8c5a760a89a1f00d0d7226f1490c3bff830186a080ffa0279bf853b68dd3ef4bf7a4a609e7f81e51a2350db463319f6825b235e8960626ffffa075cf7753c84c549859ad0476b78862464cb741dac0269c89d2a8044f9f01f6a4ffa0d85ac735b59ff2cb3b9f6eef8643f881cc986fbb02ecb9d00c9d9fe2583d2272ff830186a080ffffa075cf7753c84c549859ad0476b78862464cb741dac0269c89d2a8044f9f01f6a4ffa0cf3f7a8850dc7c27990b3e9e77c436f53a787dfb54683f8cb9e23ee6b26618efff830186a080ff80ff8080',
      lineageProof: {
        parentName:
          '0x75cf7753c84c549859ad0476b78862464cb741dac0269c89d2a8044f9f01f6a4',
        innerPuzzleHash:
          'cf3f7a8850dc7c27990b3e9e77c436f53a787dfb54683f8cb9e23ee6b26618ef',
        amount: 100000,
      },
    },
  ]

  const ownerSeed = await generateSeedFromMnemonic(
    'reform unaware fold autumn zoo napkin frame vital funny filter purse mammal license thumb coyote lizard merit crazy van brown worth eager barrel front'
  )

  it('should be get the sign coin signature', () => {
    const signature = onGetAggregateSignature(
      '0x02',
      mockLineageProof,
      ownerSeed
    )

    expect(signature.toHex()).toBe(
      'b1f1431bb0d8cfb1133589a3634214e525b3707406cf4a2ff9fd43a250146e19caa9c9096f28f2dec5fbb4bb9a402d1f06e0f0ce13f1c5dd0cdd5db572d4c30a2c7dba74b8e6c3a7e975a102a32b9a68bd2b61b6a3c30814132ee90557b8010a'
    )
  })
})
